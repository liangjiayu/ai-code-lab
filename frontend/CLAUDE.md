# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Commands

```bash
pnpm dev          # Start dev server (http://localhost:5173)
pnpm build        # Production build
pnpm start        # Serve production build
pnpm typecheck    # Generate React Router types + run tsc
pnpm lint         # Run Biome linter (check only)
pnpm lint:fix     # Run Biome linter with auto-fix
pnpm format       # Run Biome formatter
pnpm openapi2ts   # Re-generate API services from backend OpenAPI spec
```

## Architecture

This is a React SPA (SSR disabled via `react-router.config.ts`) built with React Router v7, styled after a Gemini-like chat interface.

**Tech stack:** React 19, React Router v7 (file-based routing), Vite 7, Tailwind CSS v4, shadcn/ui (Radix UI), Zustand, TanStack React Query, Axios, Remixicon icons, TypeScript, pnpm

**Path alias:** `@/` maps to `src/`

### Key directories

- `src/routes/` — File-based route components (configured in `src/routes.ts`)
- `src/components/layout/` — Layout components (Sidebar, MainHeader, ChatInput, etc.)
- `src/components/ui/` — Reusable UI primitives
- `src/stores/` — Zustand stores (chat-store.ts manages sidebar, conversations, input state)
- `src/services/api/` — **Auto-generated** API service layer from OpenAPI spec (do not edit manually)
- `src/queries/` — TanStack React Query hooks
- `src/types/` — TypeScript type definitions (Conversation, Message, ConversationGroup)
- `src/lib/` — Utilities (`cn()`, `request` axios wrapper, mock data)

### API layer

- `src/lib/request.ts` — Axios wrapper that extracts `res.data` and throws on `code !== 200`
- `src/services/api/` — Generated by `@umijs/openapi` from backend at `http://127.0.0.1:8100/openapi.json`
- Config in `openapi2ts.config.ts` — sets `requestImportStatement` to use the custom request wrapper
- **Do not manually edit** files in `src/services/api/`; run `pnpm openapi2ts` to regenerate

### Routing

Routes defined in `src/routes.ts`:

- `app-layout.tsx` — Shared layout (Sidebar + MainHeader + ChatInput + `<Outlet />`)
- `/` → `home.tsx` — Welcome page
- `/:id` → `chat.tsx` — Chat conversation detail

### State management

- **Zustand** for client-side UI state (sidebar toggle, active conversation, input value)
- **React Query** for server state — QueryClient configured with 60s staleTime, 1 retry

### Icons

- **shadcn/ui 基础组件**（`src/components/ui/`）：保留 `lucide-react`，与 shadcn 生态保持一致
- **业务组件**：使用 `@remixicon/react`，图标名称格式为 `Ri{名称}{Line|Fill}`

```tsx
import { RiMenuLine, RiPencilLine } from "@remixicon/react";

<RiMenuLine size={16} />;
```

### File naming

`src/components/` 下所有组件文件统一使用 **kebab-case** 命名（如 `chat-input.tsx`、`sidebar-header.tsx`），包括 shadcn/ui 和业务组件。

### Styling

Tailwind CSS v4 + shadcn/ui，CSS 变量定义在 `src/app.css` 中，使用 oklch 颜色空间和 shadcn 语义变量（`--sidebar`、`--accent`、`--background` 等）。Light theme with Gemini-inspired design tokens.


- 动态拼接 className 时使用 `cn()` 函数（`@/lib/utils`），不要用模板字符串拼接

### Component hierarchy

```
root.tsx (QueryClientProvider)
  └─ app-layout.tsx (Sidebar + MainHeader + ChatInput)
      ├─ / → home.tsx → WelcomeArea
      └─ /:id → chat.tsx → ChatMessageList
```

## Git Commit

- Commit 信息使用中文
- 格式：`<type>: <简要描述>`，type 用英文（feat/fix/refactor/docs/chore）
- 描述简洁，可以一句话概括，也可以用列表说明多项改动，小调整不需要详情
